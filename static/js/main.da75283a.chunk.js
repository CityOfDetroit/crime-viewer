(this["webpackJsonpcrime-viewer"]=this["webpackJsonpcrime-viewer"]||[]).push([[0],{226:function(e,t,r){e.exports=r(419)},231:function(e,t,r){},347:function(e,t,r){},419:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(46),o=r.n(i),c=(r(231),r(48)),s=r(37),E=r.n(s),l=r(21),O=r.n(l),m=r(50),p=r.n(m),d=r(196),y=r.n(d),A={"09001":{area:"Violent",description:"MURDER / NON-NEGLIGENT MANSLAUGHTER (VOLUNTARY)",category:"HOMICIDE"},"09002":{area:"Violent",description:"NEGLIGENT HOMICIDE / MANSLAUGHTER (INVOLUNTARY)",category:"HOMICIDE"},"09003":{area:"Violent",description:"NEGLIGENT HOMICIDE - VEHICLE / BOAT / SNOWMOBILE / ORV",category:"HOMICIDE"},"09004":{area:"Violent",description:"HOMICIDE - JUSTIFIABLE",category:"JUSTIFIABLE HOMICIDE"},10001:{area:"Other",description:"KIDNAPPING / ABDUCTION",category:"KIDNAPPING"},10002:{area:"Other",description:"PARENTAL KIDNAPPING",category:"KIDNAPPING"},11001:{area:"Violent",description:"CSC 1ST DEGREE - PENIS / VAGINA",category:"SEXUAL ASSAULT"},11002:{area:"Violent",description:"CSC 3RD DEGREE - PENIS / VAGINA",category:"SEXUAL ASSAULT"},11003:{area:"Violent",description:"CSC 1ST DEGREE - ORAL / ANAL",category:"SEXUAL ASSAULT"},11004:{area:"Violent",description:"CSC 3RD DEGREE - ORAL / ANAL",category:"SEXUAL ASSAULT"},11005:{area:"Violent",description:"CSC 1ST DEGREE - OBJECT",category:"SEXUAL ASSAULT"},11006:{area:"Violent",description:"CSC 3RD DEGREE - OBJECT",category:"SEXUAL ASSAULT"},11007:{area:"Violent",description:"CSC 2ND DEGREE - FORCIBLE CONTACT",category:"SEX OFFENSES"},11008:{area:"Violent",description:"CSC 4TH DEGREE - FORCIBLE CONTACT",category:"SEX OFFENSES"},12e3:{area:"Violent",description:"ROBBERY",category:"ROBBERY"},12001:{area:"Violent",description:"ROBBERY - ARMED",category:"ROBBERY"},12002:{area:"Violent",description:"ROBBERY - UNARMED",category:"ROBBERY"},13001:{area:"Violent",description:"ASSAULT AND BATTERY/SIMPLE ASSAULT",category:"ASSAULT"},13002:{area:"Violent",description:"AGGRAVATED / FELONIOUS ASSAULT",category:"AGGRAVATED ASSAULT"},13003:{area:"Violent",description:"INTIMIDATION / STALKING",category:"ASSAULT"},13012:{area:"Violent",description:"AGGRAVATED / FELONIOUS ASSAULT (DOMESTIC)",category:"AGGRAVATED ASSAULT"},13016:{area:"Violent",description:"INTIMIDATION",category:"ASSAULT"},2e4:{area:"Property",description:"ARSON",category:"ARSON"},21e3:{area:"Property",description:"EXTORTION",category:"EXTORTION"},22001:{area:"Property",description:"BURGLARY - FORCED ENTRY",category:"BURGLARY"},22002:{area:"Property",description:"BURGLARY - ENTRY WITHOUT FORCE (INTENT TO COMMIT)",category:"BURGLARY"},22003:{area:"Property",description:"ENTRY WITHOUT PERMISSION (NO INTENT)",category:"BURGLARY"},22004:{area:"Property",description:"POSSESSION OF BURGLARY TOOLS",category:"BURGLARY"},23001:{area:"Property",description:"LARCENY - POCKETPICKING",category:"LARCENY"},23002:{area:"Property",description:"LARCENY - PURSE SNATCHING",category:"LARCENY"},23003:{area:"Property",description:"LARCENY - THEFT FROM BUILDING",category:"LARCENY"},23004:{area:"Property",description:"LARCENY - FROM A COIN OPERATED MACHINE",category:"LARCENY"},23005:{area:"Property",description:"LARCENY - PERSONAL PROPERTY FROM MOTOR VEHICLE",category:"LARCENY"},23006:{area:"Property",description:"LARCENY - THEFT OF MOTOR VEHICLE PARTS / ACCESSORIES",category:"LARCENY"},23007:{area:"Property",description:"LARCENY - OTHER",category:"LARCENY"},23009:{area:"Property",description:"LARCENY FROM GROUNDS",category:"LARCENY"},23010:{area:"Property",description:"LARCENY OF MAIL",category:"LARCENY"},23079:{area:"Property",description:"LARCENY OF GASOLINE - SELF SERVICE STATION",category:"LARCENY"},24001:{area:"Property",description:"MOTOR VEHICLE THEFT",category:"STOLEN VEHICLE"},24002:{area:"Property",description:"MOTOR VEHICLE AS STOLEN PROPERTY (RECOVERED ONLY)",category:"STOLEN PROPERTY"},24003:{area:"Property",description:"MOTOR VEHICLE FRAUD",category:"STOLEN VEHICLE"},25e3:{area:"Other",description:"FORGERY / COUNTERFEITING",category:"FORGERY"},26001:{area:"Other",description:"FRAUD - FALSE PRETENSE / SWINDLE / CONFIDENCE GAME",category:"FRAUD"},26002:{area:"Other",description:"FRAUD - CREDIT CARD/AUTOMATIC TELLER MACHINE",category:"FRAUD"},26003:{area:"Other",description:"FRAUD - IMPERSONATION",category:"FRAUD"},26004:{area:"Other",description:"FRAUD - WELFARE",category:"FRAUD"},26005:{area:"Other",description:"FRAUD BY WIRE",category:"FRAUD"},26006:{area:"Other",description:"FRAUD - NON SUFFICENT FUNDS CHECKS",category:"FRAUD"},28e3:{area:"Property",description:"STOLEN PROPERTY",category:"STOLEN PROPERTY"},28003:{area:"Property",description:"POSSESSION OF STOLEN PROPERTY",category:"STOLEN PROPERTY"},29e3:{area:"Property",description:"DAMAGE TO PROPERTY",category:"DAMAGE TO PROPERTY"},30001:{area:"Other",description:"RETAIL FRAUD - MISREPRESENTATION",category:"FRAUD"},30002:{area:"Other",description:"RETAIL FRAUD - THEFT",category:"FRAUD"},35001:{area:"Other",description:"VIOLATION OF CONTROLED SUBSTANCE ACT - (VCSA)",category:"DANGEROUS DRUGS"},35002:{area:"Other",description:"NARCOTIC EQUIPMENT VIOLATIONS",category:"DANGEROUS DRUGS"},36001:{area:"Other",description:"SEXUAL PENETRATION NONFORCIBLE - BLOOD / AFFINITY",category:"SEX OFFENSES"},36002:{area:"Other",description:"SEXUAL PENETRATION NONFORCIBLE - OTHER",category:"SEX OFFENSES"},36004:{area:"Other",description:"SEX OFFENSE - OTHER",category:"SEX OFFENSES"},36005:{area:"Other",description:"INDECENT EXPOSURE",category:"SEX OFFENSES"},38001:{area:"Other",description:"FAMILY - ABUSE / NEGLECT NONVIOLENT",category:"FAMILY OFFENSE"},38002:{area:"Other",description:"FAMILY - NONSUPPORT",category:"FAMILY OFFENSE"},38003:{area:"Other",description:"FAMILY - OTHER",category:"FAMILY OFFENSE"},39001:{area:"Other",description:"GAMBLING - BETTING / WAGERING",category:"GAMBLING"},39003:{area:"Other",description:"GAMBLING - EQUIPMENT VIOLATIONS",category:"GAMBLING"},40001:{area:"Other",description:"COMMERCIALIZED SEX - PROSTITUTION",category:"SEX OFFENSES"},40002:{area:"Other",description:"COMMERCIALIZED SEX - ASSISTING / PROMOTING PROSTITUTION",category:"SEX OFFENSES"},41001:{area:"Other",description:"LIQUOR LICENSE - ESTABLISHMENT",category:"LIQUOR"},41002:{area:"Other",description:"LIQUOR VIOLATIONS - OTHER",category:"LIQUOR"},41096:{area:"Other",description:"ALCOHOL - MINOR IN POSSESSION",category:"LIQUOR"},48e3:{area:"Other",description:"OBSTRUCTING POLICE",category:"OBSTRUCTING THE POLICE"},48072:{area:"Other",description:"IMPERSONATING OF A POLICE OFFICER",category:"OBSTRUCTING THE POLICE"},5e4:{area:"Other",description:"OBSTRUCTING JUSTICE",category:"OBSTRUCTING JUDICIARY"},50012:{area:"Other",description:"PROBATION VIOLATION",category:"OBSTRUCTING JUDICIARY"},52001:{area:"Other",description:"WEAPONS OFFENSE - CONCEALED",category:"WEAPONS OFFENSES"},52002:{area:"Other",description:"WEAPONS OFFENSE - EXPLOSSIVES",category:"WEAPONS OFFENSES"},52003:{area:"Other",description:"WEAPONS OFFENSE - OTHER",category:"WEAPONS OFFENSES"},53001:{area:"Other",description:"DISORDERLY CONDUCT - GENERAL",category:"DISORDERLY CONDUCT"},53002:{area:"Other",description:"PUBLIC PEACE - OTHER",category:"DISORDERLY CONDUCT"},54001:{area:"Other",description:"ACCIDENT, HIT & RUN",category:"OUIL"},55e3:{area:"Other",description:"HEALTH AND SAFETY",category:"OTHER"},55086:{area:"Other",description:"ANIMAL - CRUELTY",category:"OTHER"},57001:{area:"Other",description:"TRESPASS",category:"OTHER"},57002:{area:"Other",description:"INVASION OF PRIVACY - OTHER",category:"OTHER"},7e4:{area:"Other",description:"RUNAWAY",category:"RUNAWAY"},73e3:{area:"Other",description:"MISCELLANEOUS CRIMINAL OFFENSE",category:"MISCELLANEOUS"},75e3:{area:"Other",description:"SOLICITATION (ALL CRIMES EXCEPT PROSTITUTION)",category:"SOLICITATION"}},R=function(e){var t=e.intersection,r=e.setIntersection,i=e.timeRange,o=e.crimeTypes,s=Object(a.useState)(null),l=Object(c.a)(s,2),O=l[0],m=l[1];return Object(a.useEffect)((function(){p.a.accessToken="pk.eyJ1IjoiY2l0eW9mZGV0cm9pdCIsImEiOiJjaXZvOWhnM3QwMTQzMnRtdWhyYnk5dTFyIn0.FZMFi0-hvA60KYnI-KivWg";var e=new p.a.Map({container:"map",style:"mapbox://styles/cityofdetroit/cj9fqy8y48aq02smdgong5vc0",center:[-83.0457,42.331],zoom:14,minZoom:13.01});e.on("load",(function(){e.addControl(new p.a.NavigationControl),e.addControl(new p.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),e.addControl(new y.a({accessToken:p.a.accessToken,mapboxgl:p.a,bbox:[-83.287803,42.255192,-82.910451,42.45023]}),"top-left"),m(e),e.addSource("rms-far",{type:"vector",url:"mapbox://cityofdetroit.rms_mapbox_far"}),e.addSource("intersections",{type:"geojson",data:{type:"FeatureCollection",features:[]}});var t=function(){var t=e.queryRenderedFeatures({layers:["rms-incidents-far"]}),r=E.a.groupBy(t,"geometry.coordinates"),a=Object.keys(r).map((function(e){return{type:"Feature",geometry:r[e][0].geometry,properties:{id:e.toString(),count:r[e].length,incidents:r[e].map((function(e){return e.properties}))}}}));setTimeout((function(){return e.getSource("intersections").setData({type:"FeatureCollection",features:a})}),500)};e.addLayer({id:"rms-incidents-far",source:"rms-far","source-layer":"rms_mapbox_far",filter:["all",[">=","incident_timestamp",i[0]],["<=","incident_timestamp",i[1]]],type:"circle",paint:{"circle-opacity":0}}),e.addLayer({id:"intersections",source:"intersections",type:"circle",minzoom:13.01,paint:{"circle-opacity":.75,"circle-radius":["+",["*",["log2",["get","count"]],4],5]}}),e.addLayer({id:"intersections-highlight",source:"intersections",type:"circle",filter:["==","id","none"],minzoom:13.01,paint:{"circle-opacity":.95,"circle-color":"#FFAA1D","circle-radius":["+",["round",["*",["log2",["get","count"]],4]],11]}},"intersections"),t(),e.on("click",(function(t){var a=e.queryRenderedFeatures(t.point,{layers:["intersections","intersections-highlight"]});a.length>0&&(e.setFilter("intersections-highlight",["==","id",a[0].properties.id]),console.log(a),console.log(JSON.parse(a[0].properties.incidents)),e.easeTo({center:t.lngLat}),r(a[0]))})),e.on("mouseenter","intersections",(function(t){e.getCanvas().style.cursor="crosshair"})),e.on("mouseout","intersections",(function(t){e.getCanvas().style.cursor="default"})),e.on("moveend",(function(e){setTimeout((function(){return t()}),200)})),setTimeout((function(){return e.setZoom(14.001)}),500)}))}),[]),Object(a.useEffect)((function(){if(O){var e=[];E.a.toPairs(o).forEach((function(t){var r=Object.keys(A).filter((function(e){return A[e].area===t[0]&&t[1].indexOf(A[e].category)>-1}));e=e.concat(r)}));var a=["!=","arrest_charge","nothing"];e.length>0&&(a=["in","arrest_charge"].concat(e)),O.setFilter("rms-incidents-far",["all",[">=","incident_timestamp",i[0]],["<=","incident_timestamp",i[1]],a]),setTimeout((function(){var e=O.queryRenderedFeatures({layers:["rms-incidents-far"]});console.log(e);var a=E.a.groupBy(e,"geometry.coordinates"),n=Object.keys(a).map((function(e){return{type:"Feature",geometry:a[e][0].geometry,properties:{id:e.toString(),count:a[e].length,incidents:a[e].map((function(e){return e.properties}))}}}));if(O.getSource("intersections").setData({type:"FeatureCollection",features:n}),t){var i=n.filter((function(e){return e.properties.id===t.properties.id}));console.log(i[0]),i.length>0&&r(i[0])}}),500)}}),[i,o]),n.a.createElement("div",{id:"map",style:{gridArea:"m"}})},S=function(e){var t=e.close,r=e.children;return n.a.createElement("div",{style:{gridArea:"f",padding:"1em",height:"100%",overflowY:"auto"}},n.a.createElement("header",null,n.a.createElement("div",{className:"rowDiv"},n.a.createElement("div",{className:"rowDiv"},n.a.createElement("img",{src:"https://cityofdetroit.github.io/crime-viewer/img/green.png",style:{height:50,display:"inline-block"}}),n.a.createElement("h1",{className:"hul"},"Detroit Crime Viewer")),t)),r)},T=r(428),N=r(430),I=r(49),u=function(e){var t=e.incident,r=(e.stripe,{fontWeight:"600",fontSize:"1.1em",color:"rgba(0,0,0,.65)",fontFamily:"Roboto Condensed"}),a={fontWeight:"500",fontSize:"1.1em",color:"rgba(0,0,0,.65)",fontFamily:"Roboto Condensed"},i={Date:O()(1e3*t.incident_timestamp).format("ddd, MMMM Do YYYY"),Time:O()(1e3*t.incident_timestamp).format("h:mm a"),Offense:A[t.arrest_charge].description,"Report #":t.report_number};return n.a.createElement(T.a,{definition:!0,compact:!0},n.a.createElement(T.a.Body,null,Object.entries(i).map((function(e){return n.a.createElement(T.a.Row,null,n.a.createElement(T.a.Cell,{width:2,style:r},e[0]),n.a.createElement(T.a.Cell,{width:10,style:a},e[1]))}))))},g=function(e){var t=e.intersection,r=t.properties.incidents;"string"===typeof t.properties.incidents&&(r=JSON.parse(t.properties.incidents).sort((function(e,t){return e.incident_timestamp>t.incident_timestamp})));return n.a.createElement(N.a,{style:{width:"100%"}},n.a.createElement(N.a.Content,null,n.a.createElement(N.a.Header,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:0}},n.a.createElement(I.a,{name:"crosshairs",size:"large"}),n.a.createElement("h2",{className:"hul",style:{margin:0,textAlign:"right"}},r[0].inter," & ",r[0].main))),n.a.createElement(N.a.Content,{style:{maxHeight:"40vh",overflowY:"auto"}},r.map((function(e,t){return n.a.createElement(u,{incident:e,key:e.report_number+t,stripe:t%2===0})}))),n.a.createElement(N.a.Content,{extra:!0},r.length," matching incident",r.length>1?"s":""))},C=(r(346),r(426)),h=(r(347),r(429)),L=function(e){var t=e.crimeTypes,r=e.setCrimeTypes,a=E.a.groupBy(E.a.uniqBy(Object.values(A),(function(e){return e.area+e.category})),"area");return n.a.createElement("section",{style:{marginTop:"1em"}},n.a.createElement("h3",null,"Change crime types"),Object.keys(a).sort((function(e,t){return e<t})).map((function(e){var i=a[e].sort((function(e,t){return t.category<e.category})).map((function(e){return{key:"".concat(e.area,"_").concat(e.category),text:e.category,value:"".concat(e.area,"_").concat(e.category)}}));return n.a.createElement("div",{className:"rowDiv"},n.a.createElement("h4",{style:{display:"inline-block",minWidth:100,fontWeight:500,margin:0}},e),n.a.createElement(h.a,{id:e,onChange:function(e,n){var i=n.id,o={};Object.keys(a).forEach((function(e){e!==i?o[e]=t[e]:o[i]=n.value.map((function(e){return e.split("_")[1]}))})),r(o)},options:i,placeholder:"".concat(e," crimes"),labeled:!0,fluid:!0,multiple:!0,selection:!0}))})))},f=r(425),F=r(74),D=function(e){var t=e.timeRange,r=e.setTimeRange;return n.a.createElement("section",null,n.a.createElement("h3",null,"Date range"),n.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},n.a.createElement(f.a,{type:"date",name:"beginning",labelPosition:"left",min:O()().subtract(1,"year").format("YYYY-MM-DD"),max:O()().format("YYYY-MM-DD"),value:O()(t[0],"X").format("YYYY-MM-DD"),onChange:function(e,a){return r([parseInt(O()(a.value,"YYYY-MM-DD").format("X")),t[1]])}},n.a.createElement(F.a,{basic:!0},"From:"),n.a.createElement("input",null)),n.a.createElement(f.a,{type:"date",name:"ending",labelPosition:"left",min:O()().subtract(1,"year").format("YYYY-MM-DD"),max:O()().format("YYYY-MM-DD"),value:O()(t[1],"X").format("YYYY-MM-DD"),onChange:function(e,a){return r([t[0],parseInt(O()(a.value,"YYYY-MM-DD").format("X"))])}},n.a.createElement(F.a,{basic:!0},"To:"),n.a.createElement("input",null))))},Y=r(431),U=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(C.a.Header,{as:"h2",style:{fontFamily:"Montserrat",display:"flex",alignItems:"center",justifyContent:"space-between",margin:0}},n.a.createElement("h2",{style:{margin:0}},"Welcome to the City of Detroit Crime Viewer")),n.a.createElement(C.a.Content,null,n.a.createElement(Y.a,null,n.a.createElement(Y.a.Header,null,"Note: This tool is currently in BETA mode."),n.a.createElement(Y.a.Content,null,"Please submit all feedback to ",n.a.createElement("a",{href:"https://app.smartsheet.com/b/form/4b5e8883ad654704b7d04d1f9c747896"},"this web form"),".      ")),n.a.createElement("p",{style:{fontSize:"1.25em"}},"You can use this tool to view crimes which occurred in the city of Detroit over the past year."),n.a.createElement("p",{style:{fontSize:"1.25em"}},n.a.createElement(I.a,{name:"filter"}),"Adjust the ",n.a.createElement("b",null,"date range")," or the list of ",n.a.createElement("b",null,"crime types")," below to change which incidents appear on the map."),n.a.createElement("p",{style:{fontSize:"1.25em"}},n.a.createElement(I.a,{name:"search"}),"You can ",n.a.createElement("b",null,"search for an address")," using the search bar in the top left of the map, or click the ",n.a.createElement("b",null,"geolocate")," ",n.a.createElement(I.a,{name:"crosshairs"})," button to zoom to your current location."),n.a.createElement("p",{style:{fontSize:"1.25em"}},"Click ",n.a.createElement("b",null,"an intersection on the map")," to bring up more information about the incidents which occurred there and match the current set of filters."),n.a.createElement("p",{style:{fontSize:"1.25em"}},"Do you want to access the raw data behind this tool? Visit the ",n.a.createElement("b",null,n.a.createElement("a",{href:"https://data.detroitmi.gov/datasets/rms-crime-incidents"},"RMS Crime Incidents dataset"))," on the City's open data portal."),n.a.createElement(Y.a,null,n.a.createElement(Y.a.Header,null,"A note on anonymization"),n.a.createElement(Y.a.Content,null,"In order to protect the privacy of individuals connected to these incidents, the geographic coordinates of all incidents have been snapped to a nearby intersection. The coordinates and address provided in this data reflect the nearby anonymized intersection."))))},P=function(e){var t=e.children;return n.a.createElement(N.a,{style:{width:"100%"}},n.a.createElement(N.a.Content,null,n.a.createElement(N.a.Header,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:0}},n.a.createElement(I.a,{name:"filter",size:"large"}),n.a.createElement("h2",{style:{margin:0}},"Adjust filters"))),n.a.createElement(N.a.Content,{style:{}},t))};var M=function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),r=t[0],i=t[1],o=Object(a.useState)(!0),s=Object(c.a)(o,2),E=s[0],l=s[1],m=Object(a.useState)([O()().subtract(14,"days").unix(),O()().unix()]),p=Object(c.a)(m,2),d=p[0],y=p[1],A=Object(a.useState)({Violent:[],Property:[],Other:[]}),T=Object(c.a)(A,2),N=T[0],u=T[1];return n.a.createElement("div",{className:"App",style:{display:"grid",gridTemplateColumns:"minmax(450px, 2fr) 5fr",gridTemplateRows:"2fr 3fr",gridTemplateAreas:'"f m" "f m"',height:"100vh",width:"100vw"}},n.a.createElement(C.a,{open:E,onClose:function(){return l(!1)},closeIcon:!0},n.a.createElement(U,null)),n.a.createElement(S,{close:n.a.createElement(I.a,{name:"help circle",size:"large",onClick:function(){return l(!0)}})},n.a.createElement(P,null,n.a.createElement(D,{timeRange:d,setTimeRange:y}),n.a.createElement(L,{crimeTypes:N,setCrimeTypes:u})),r&&n.a.createElement(g,{intersection:r})),n.a.createElement(R,{intersection:r,setIntersection:i,timeRange:d,crimeTypes:N}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[226,1,2]]]);
//# sourceMappingURL=main.da75283a.chunk.js.map